<!DOCTYPE html>
<html lang="en">
<head>
    <!-- Previous head content remains the same -->
</head>
<body class="bg-gray-50">
    <div class="max-w-7xl mx-auto p-4 mt-10 bg-white rounded shadow">
        <h2 class="text-3xl font-bold mb-6 text-center">Submit Your Quote</h2>
        
        <!-- Tender Overview -->
        <div id="tenderOverview" class="mb-8">
            <h3 class="text-2xl font-semibold mb-4">Tender Details</h3>
            <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                <!-- Basic Information -->
                <div class="border p-4 rounded shadow-sm">
                    <h4 class="font-semibold mb-2">Basic Information</h4>
                    <p><strong>Tender ID:</strong> <span id="tenderId"></span></p>
                    <p><strong>Transport Mode:</strong> <span id="transportMode"></span></p>
                    <p><strong>Weight Bucket:</strong> <span id="weightBucket"></span></p>
                    <p><strong>Weight Type:</strong> <span id="weightType"></span></p>
                    <p><strong>Incoterms:</strong> <span id="incoterms"></span></p>
                </div>
                
                <!-- Delivery Details -->
                <div class="border p-4 rounded shadow-sm">
                    <h4 class="font-semibold mb-2">Delivery Details</h4>
                    <p><strong>Delivery Type:</strong> <span id="deliveryType"></span></p>
                    <p><strong>Load Type:</strong> <span id="loadType"></span></p>
                    <p><strong>Pallets:</strong> <span id="pallets"></span></p>
                    <p><strong>Volume (CBM):</strong> <span id="volume"></span></p>
                </div>
                
                <!-- Additional Information -->
                <div class="border p-4 rounded shadow-sm">
                    <h4 class="font-semibold mb-2">Additional Information</h4>
                    <p><strong>Pallet Type:</strong> <span id="palletType"></span></p>
                    <p><strong>Container Type:</strong> <span id="containerType"></span></p>
                    <p><strong>Air Weight (KG):</strong> <span id="airWeight"></span></p>
                    <p><strong>Peak Season:</strong> <span id="peakSeason"></span></p>
                    <p><strong>Peak Details:</strong> <span id="peakDetails"></span></p>
                </div>
                
                <!-- Collection Details -->
                <div class="border p-4 rounded shadow-sm">
                    <h4 class="font-semibold mb-2">Collection Details</h4>
                    <p><strong>Country:</strong> <span id="collectionCountry"></span></p>
                    <p><strong>Postcode:</strong> <span id="collectionPostcode"></span></p>
                    <p><strong>Location:</strong> <span id="collectionLocation"></span></p>
                </div>
                
                <!-- Delivery Location -->
                <div class="border p-4 rounded shadow-sm">
                    <h4 class="font-semibold mb-2">Delivery Location</h4>
                    <p><strong>Country:</strong> <span id="deliveryCountry"></span></p>
                    <p><strong>Postcode:</strong> <span id="deliveryPostcode"></span></p>
                    <p><strong>Location:</strong> <span id="deliveryLocation"></span></p>
                </div>
                
                <!-- Service Requirements -->
                <div class="border p-4 rounded shadow-sm">
                    <h4 class="font-semibold mb-2">Service Requirements</h4>
                    <p><strong>Urgency:</strong> <span id="urgency"></span></p>
                    <p><strong>Preferred Delivery:</strong> <span id="preferredDelivery"></span></p>
                    <p><strong>Hide Documents:</strong> <span id="hideDocuments"></span></p>
                </div>

                <!-- Waypoints Section -->
                <div class="border p-4 rounded shadow-sm col-span-3">
                    <h4 class="font-semibold mb-2">Waypoints</h4>
                    <div id="waypointsContainer" class="grid grid-cols-1 gap-2">
                        <!-- Waypoints will be populated here -->
                    </div>
                </div>
            </div>
        </div>

        <!-- Previous form content remains the same -->
    </div>

    <script>
        // Previous Firebase config remains the same

        async function populateTenderDetails() {
            if (!quoteId) {
                displayMessage('Missing quoteId parameter');
                return;
            }

            try {
                const quoteDoc = await db.collection('quotes').doc(quoteId).get();
                const quoteData = quoteDoc.data();
                
                // Basic Information
                document.getElementById('tenderId').textContent = quoteId;
                document.getElementById('transportMode').textContent = quoteData.transportMode || 'N/A';
                document.getElementById('weightBucket').textContent = quoteData.weightBucket || 'N/A';
                document.getElementById('weightType').textContent = quoteData.weightType === 'perPallet' ? 'Per Pallet' : 'Total Load';
                document.getElementById('incoterms').textContent = quoteData.incoterms || 'N/A';
                
                // Delivery Details
                document.getElementById('deliveryType').textContent = quoteData.deliveryType || 'N/A';
                document.getElementById('loadType').textContent = quoteData.loadType || 'N/A';
                document.getElementById('pallets').textContent = quoteData.pallets || 'N/A';
                document.getElementById('volume').textContent = quoteData.volume ? `${quoteData.volume} CBM` : 'N/A';
                
                // Additional Information
                document.getElementById('palletType').textContent = quoteData.palletType || 'N/A';
                document.getElementById('containerType').textContent = quoteData.containerType || 'N/A';
                document.getElementById('airWeight').textContent = quoteData.airWeight ? `${quoteData.airWeight} kg` : 'N/A';
                document.getElementById('peakSeason').textContent = quoteData.isPeakSeason ? 'Yes' : 'No';
                document.getElementById('peakDetails').textContent = quoteData.peakSeasonDetails || 'N/A';
                
                // Collection details
                document.getElementById('collectionCountry').textContent = quoteData.collection?.country || 'N/A';
                document.getElementById('collectionPostcode').textContent = quoteData.collection?.postcode || 'N/A';
                document.getElementById('collectionLocation').textContent = quoteData.collection?.location || 'N/A';
                
                // Delivery details
                document.getElementById('deliveryCountry').textContent = quoteData.delivery?.country || 'N/A';
                document.getElementById('deliveryPostcode').textContent = quoteData.delivery?.postcode || 'N/A';
                document.getElementById('deliveryLocation').textContent = quoteData.delivery?.location || 'N/A';

                // Service Requirements
                document.getElementById('urgency').textContent = quoteData.urgency || 'N/A';
                document.getElementById('preferredDelivery').textContent = quoteData.preferredDeliveryDate || 'N/A';
                document.getElementById('hideDocuments').textContent = quoteData.hideDocuments ? 'Yes' : 'No';
                
                // Waypoints
                const waypointsContainer = document.getElementById('waypointsContainer');
                waypointsContainer.innerHTML = ''; // Clear existing content
                
                if (quoteData.waypoints && quoteData.waypoints.length > 0) {
                    quoteData.waypoints.forEach((waypoint, index) => {
                        waypointsContainer.innerHTML += `
                            <div class="p-2 bg-gray-50 rounded">
                                <p class="font-medium">Waypoint ${index + 1}</p>
                                <p>Country: ${waypoint.country}</p>
                                <p>Postcode: ${waypoint.postcode}</p>
                            </div>
                        `;
                    });
                } else {
                    waypointsContainer.innerHTML = '<p class="text-gray-500">No waypoints specified</p>';
                }

                // Initialize form with currency from quote
                if (quoteData.currency) {
                    document.querySelector('select[name="currency"]').value = quoteData.currency;
                }

            } catch (error) {
                console.error('Error fetching quote:', error);
                displayMessage('Error loading quote details');
            }
        }

        // Call the populate function when page loads
        window.addEventListener('DOMContentLoaded', populateTenderDetails);

        // Previous form submission code remains the same
    </script>
</body>
</html>
